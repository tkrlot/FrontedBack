<!DOCTYPE html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=0.5">
<title>SyndiShanX - Class Updater</title>
<link rel="stylesheet" href="Fonts/Font_Awesome.min.css">
<link rel="icon" href="Images/Global/Icon_Tab.webp">
<link rel="stylesheet" href="GlobalCSS.css">
<style type="text/css">
body {
	background-color: #1a002b; /* Very Dark Purple background */
	color: #fff; /* White text for general readability */
}
.fileInputVisible, .outputButton {
	background-color: rgba(80, 0, 80, 0.5); /* Dark Purple with more opacity */
	padding: 28px;
	color: #fff;
	font: 28px Arial;
	font-weight: bold;
	text-align: center;
	border: 1px solid #5b003a; /* Slightly darker purple border */
	border-radius: 8px;
	cursor: pointer;
}
.outputButton {
	padding: 18px;
	margin: 10px;
	color: #fff;
	font: 18px Arial;
	font-weight: bold;
	text-align: center;
	border: 1px solid #5b003a;
	border-radius: 8px;
	cursor: pointer;
}
.fileInputVisible:hover, .outputButton:hover {
	background-color: rgba(120, 30, 120, 0.6); /* Lighter Dark Purple on hover */
	border: 1px solid #8d004c; /* Lighter border on hover */
}
.fileInputVisible:disabled, .outputButton:disabled {
	background-color: rgba(50, 0, 50, 0.1); /* Very Dark Purple */
	border: 1px solid #3c002c; /* Very Dark Purple border */
	cursor: not-allowed;
}
.fileInput {
	display: none;
}
.container {
	background-color: #2e0032; /* Dark Purple background */
	border: 1px solid #4b0034;
	border-radius: 8px;
	min-width: 800px;
	width: 50%;
	height: fit-content;
	padding-bottom: 50px;
	color: #fff;
}
#themeTextArea {
	background-color: #3d0048; /* Slightly lighter Dark Purple */
	border: 1px solid #4b0034;
	border-radius: 8px;
	width: 80%;
	height: 200px;
	color: #fff;
	resize: none;
}
.link {
	color: #c084d2; /* Light Lavender for links */
	font-weight: bold;
}
.theme {
	background-color: #c084d2; /* Light Lavender for theme button */
}
.theme:hover {
	background-color: #a76bd3; /* Slightly darker Lavender on hover */
}
h3, h4 {
	color: #fff; /* Ensure headers are readable */
}
</style>
</head>
<body lang="">
<div class="MainWrapper" align="center">
<!--Nav Template End-->

	<br><br><br>
	<div class='container'><br><br>
		<h3>Either Upload your Theme File or Paste it into the Textarea</h3>
		<h4>(Optional) Either Upload a Custom Diff File or Use the <a class="link" target="_blank" href="https://raw.githubusercontent.com/SyndiShanX/Update-Classes/main/Changes.txt">Included One</a></h4><br><br><br>
		<label for='theme-file' class='fileInputVisible theme' role='button'>Upload Theme File</label><label for='diff-file' class='fileInputVisible' role='button' style="margin-left: 5%;">Upload Diff File</label>
		<input id='theme-file' type='file' class='fileInput' onchange='loadThemeFile()' style='color: #fff;'><br>
		<input id='diff-file' type='file' class='fileInput' onchange='loadChangesFile()' style='color: #fff;'><br><br><br>
		<font id='textAreaStatus'>If you use the Textarea, you have to Click off after you Paste your Theme for it to Update</font><br><br>
		<textarea id='themeTextArea' onchange='updateClasses("textarea")'></textarea><br><br>
		<button class='outputButton' onClick='updateClasses("file")'>Download Updated Theme</button>
		<button class='outputButton' onClick='updateClasses("clipboard")'>Copy to Clipboard</button><br>
		<h4>Credits:</h4>
		<div id='creditsURL'></div>
		<font style='display: none;' id='diffFileURL'></font>
		<font style='display: none;' id='diffFile'></font>
	</div>

<!--Nav Template Start-->
</div>
<script>
async function loadChangesFileURL() {
	const url = 'https://raw.githubusercontent.com/SyndiShanX/Update-Classes/main/Changes.txt'
	let rawFile = await fetch(url);
	let rawText = await rawFile.text();
	document.getElementById('diffFileURL').innerHTML = rawText
	const creditsURL = 'https://raw.githubusercontent.com/SyndiShanX/Update-Classes/main/Credits.txt'
	let rawCreditsFile = await fetch(creditsURL);
	let rawCreditsText = await rawCreditsFile.text();
	document.getElementById('creditsURL').innerHTML = rawCreditsText
}
loadChangesFileURL()

function loadChangesFile() {
	input = document.getElementsByClassName('fileInput')[1];
	
	if (typeof window.FileReader !== 'function') {
		alert("The file API isn't supported on this browser yet");
		return;
	}
	
	if (!input) {
		alert('Unable to find the fileInput element');
	} else if (!input.files) {
		alert("This browser doesn't seem to support the files property of file inputs");
	} else {
		file = input.files[0];
		fr = new FileReader();
		fr.onload = function () { document.getElementById('diffFile').textContent = fr.result; }
		fr.readAsText(file);
	}
}

function loadThemeFile() {
	var input, file, fr;
	
	if (typeof window.FileReader !== 'function') {
		alert("The file API isn't supported on this browser yet");
		return;
	}
	
	input = document.getElementsByClassName('fileInput')[0];
	
	if (!input) {
		alert('Unable to find the fileInput element');
	} else if (!input.files) {
		alert("This browser doesn't seem to support the files property of file inputs");
	} else {
		file = input.files[0];
		fr = new FileReader();
		fr.onload = receivedText;
		fr.readAsText(file);
		outputName = file.name
		themeFile = fr
		document.getElementById('textAreaStatus').style = 'display: none;'
		document.getElementById('themeTextArea').style = 'display: none;'
		document.getElementsByTagName('br')[12].remove()
		document.getElementsByTagName('br')[12].remove()
		document.getElementsByTagName('br')[12].remove()
	}

	async function receivedText(e) {
		let lines = e.target.result;
	}
}

function updateClasses(outputMethod) {
	var i = 0
	if (document.getElementsByClassName('fileInput')[1].files.length != 1) {
		rawText = document.getElementById('diffFileURL').innerHTML
	} else {
		rawText = document.getElementById('diffFile').innerHTML
	}
	//console.log(rawText)
	classNum = rawText.split('\n').length - 1
	changesText = rawText.split('\n')
	if (outputMethod == 'textarea') {
		themeText = document.getElementById('themeTextArea').value
	} else {
		if (document.getElementById('themeTextArea').value != '') {
			themeText = document.getElementById('themeTextArea').value
		} else {
			themeText = themeFile.result
		}
	}
	
	while (i < classNum) {
		class1 = changesText[i].split('\r')[0]
		class2 = changesText[i + 1].split('\r')[0]
	
		themeText = themeText.replaceAll(class1, class2)
	
		i = i + 2
	}
	
	if (outputMethod == 'textarea') {
		document.getElementById('textAreaStatus').innerHTML = 'Updated!'
		document.getElementById('themeTextArea').value = themeText
	} else if (outputMethod == 'file') {
		var synOutput = document.createElement('a');
		if (document.getElementById('themeTextArea').value != '') {
			document.getElementById('textAreaStatus').innerHTML = 'Updated!'
			document.getElementById('themeTextArea').value = themeText
			outputName = 'Output.theme.css'
		}
		const blob = new Blob([themeText], { type: 'text/plain' });
		url = URL.createObjectURL(blob);
		synOutput.download = outputName;
		synOutput.href = url;
		synOutput.click();
	} else if (outputMethod == 'clipboard') {
		if (document.getElementById('themeTextArea').value != '') {
			document.getElementById('textAreaStatus').innerHTML = 'Updated!'
			document.getElementById('themeTextArea').value = themeText
			navigator.clipboard.writeText(document.getElementById('themeTextArea').value);
		} else {
			navigator.clipboard.writeText(themeText);
		}
	}
}
</script>
<script src="GlobalNavbar.js"></script>
<script src="GlobalNavbarFixer.js"></script>
</body>
</html>
